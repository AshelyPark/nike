<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ch.nike.mapper.UserOrderMapper">
	<select id="orderlist" resultType="userorder"><!-- 관리자 주문 목록 -->
		select	*
		from	user_order
	order by	order_no desc
	</select>

	<select id="userorderselect" parameterType="string"	resultType="userorder">
		select	uo.*,
				uod.*
		from	user_order uo,
				user_order_detail uod
		where	uo.order_no = uod.order_no
			and uo.email = #{email}
	order by	uo.order_no desc
	</select>
	<select id="selectUserOrder" parameterType="string" resultType="UserOrder"> <!-- mypage - orders -->
		select	*
		from	user_order
		where	email = #{email}
	order by	order_no desc
	</select>
	<select id="selectOrderDetail" parameterType="integer" resultType="UserOrder">
		select	p.*,
				uod.*,
				a.*,
				pp.product_photo,
				pp.color,
				uo.order_date,
				pd.product_size,
				r.*
		from	product p,
				(select	*
				from	user_order_detail
				where	order_no = #{order_no}) uod,
				address a,
				(select	*
				from	user_order
				where	order_no = #{order_no}) uo,asa
				product_photo pp,
				product_detail pd,
				refund r
		where	p.product_no = uod.product_no
			and uo.addr_no = a.addr_no
			and p.product_no = pp.product_no
			and p.product_no = pd.product_no
			and r.order_detail_no = uod.order_detail_no
	</select>
	<select id="paginglist" parameterType="pagingbean" resultType="userorder">
		select 	* 
		from 	(select a.*, rowNum rn from (select * from user_order order by order_no desc)a) 
		where 	rn between #{startRow} and #{endRow}
	</select>
</mapper>