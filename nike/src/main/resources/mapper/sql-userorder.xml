<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ch.nike.mapper.UserOrderMapper">
	<select id="orderlist" resultType="userorder"><!-- 관리자 주문 목록 -->
		select	*
		from	user_order
	order by	order_no desc
	</select>

	<select id="userorderselect" parameterType="string"	resultType="userorder">
		select	uo.*,
				uod.*
		from	user_order uo,
				user_order_detail uod
		where	uo.order_no = uod.order_no
			and uo.email = #{email}
	order by	uo.order_no desc
	</select>
	<select id="selectUserOrder" parameterType="string" resultType="UserOrder"> <!-- mypage - orders -->
		select	*
		from	user_order
		where	email = #{email}
	order by	order_no desc
	</select>
	<select id="selectOrderDetail" parameterType="integer" resultType="UserOrder">
		select	pd.*, 
				uod.*, 
				a.*, 
				pp.*,
				p.*
		from	product p,
				product_photo pp, 
				product_detail pd, 
				(select * from user_order_detail where order_no=#{orderNo}) uod, 
				address a, 
				(select * from user_order where order_no=#{orderNo}) uo 
		where	pd.product_detail_no=uod.product_detail_no 
			and uo.addr_no=a.addr_no 
			and pd.product_no=pp.product_no 
			and pd.product_no=p.product_no
			and batch = 1 
			and pd.color = pp.color
	</select>
</mapper>