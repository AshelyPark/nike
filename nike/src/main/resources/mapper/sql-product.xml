<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ch.nike.mapper.ProductMapper">

	<!-- ProductCon -->
	<select id = "list" resultType="Product"  >
		select	p.*,
				ph.product_photo,
				ph.color			
		from	product p,
				product_photo ph
		where	p.product_no = ph.product_no
			and ph.batch = 1
	order by	p.product_no desc
	</select>
	<select id="selectsoo" parameterType="integer" resultType="Product">
		 select	* 
		 from 	product 
		 where 	product_no = #{productNo}
	</select>
	
	
	
	
	<!-- Admincon -->
	<select id="paginglist" parameterType="pagingbean" resultType="product">
		select 	* 
		from 	(select	a.*,
						rowNum rn
				from	(select	p.*,
								d.color,
								d.stock,
								d.product_size,
								h.product_photo,
								d.product_detail_no 
						from	product p,
								product_detail d,
								product_photo h
						where	p.product_no = d.product_no
							and p.product_no = h.product_no(+)
							and d.color = h.color
							and batch = 1
					order by	p.product_no) a
				) 
		where	rn between #{startRow} and #{endRow}
	</select>
	<select id="getTotal" resultType="integer"> <!-- 페이징용 전체 상품 카운트 by창률 -->
		select 	count(*) 
		from	product p,
				product_detail d,
				product_photo h
		where	p.product_no = d.product_no
			and p.product_no = h.product_no(+)
			and d.color = h. color
			and batch = 1
	</select>
	<select id="select" parameterType="integer" resultType="product">
		select	p.*,
				d.color,
				d.stock,
				d.product_size,
				h.product_photo,
				d.product_detail_no 
		from	product p,
				product_detail d,
				product_photo h
		where	p.product_no = d.product_no
			and p.product_no = h.product_no(+)
			and d.color = h.color
			and d.product_Detail_No=#{productDetailNo}
                        and batch=1
	</select>
	<select id="selectproductNo" resultType="integer">
		select	nvl(max(product_no),0) + 1 productNo
		from	product
	</select>
	<insert id="productinsert" parameterType="product">
		insert into product 
			values	(#{productNo}, 
					#{productName}, 
					#{categoryNo}, 
					#{price}, 
					#{detail}, 
					#{gender})
	</insert>
	<update id="productupdate" parameterType="product">
		update 	product 
		set 	category_No=#{categoryNo}, 
				product_Name=#{productName}, 
				price=#{price}, 
				detail=#{detail}, 
				gender=#{gender}
		where	product_No=#{productNo}
	</update>	
	<select id="adminproductlist" resultType="product"><!-- 관리자 상품 목록 -->
		select	p.*,
				d.color,
				d.stock,
				d.product_size,
				h.product_photo,
				d.product_detail_no 
		from	product p,
				product_detail d,
				product_photo h
		where	p.product_no = d.product_no
			and p.product_no = h.product_no
			and d.color = h.color
			and h.batch = 1
	order by	p.product_no
	</select>
	
</mapper>